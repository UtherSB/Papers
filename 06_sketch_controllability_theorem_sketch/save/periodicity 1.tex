\include{header}
\DeclareMathOperator{\Real}{Re}

\begin{document}
\title{Conditions on the Hamiltonian for periodic symplectic transformations}
\maketitle

\section{Notation}\label{sec:notation}
\begin{equation}
\Omega = \bigoplus_{i=1}^n \omega \quad  \text{where} \quad \omega = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix}
\end{equation}

We consider the Hamiltonian for a system $\hat{H} = \frac{1}{2}z^T H z$ where
\begin{equation} z = (\hat{x}_1, \hat{p_1}, \ldots, \hat{x}_n, \hat{p}_n)^T. \end{equation}
and where
\begin{equation} [\hat{x}_i,\hat{p}_j] = i\Omega_{ij}. \end{equation}

The corresponding evolution equation can be shown to be
\begin{equation} \dot{z} = Az \end{equation} where $A \in Sp(2n,\mathbb{R})$ and $A = \Omega H$.

If the matrix $H$ is block diagonal such that
\begin{equation} H = \bigoplus_{i=1}^n H_j \end{equation} so that each $H_j$ acts on one $\hat{x}_j$, $\hat{p}_j$ pair then we refer to $H_j$ as an $x_jp_j$-submatrix of $H$.

Also:
\begin{equation}
\mathbf{0}_2 = \begin{pmatrix} 0 & 0 \\ 0 & 0 \end{pmatrix}
\end{equation}

\section{Lemmas}
%%%%%%%%%%%%%%%% 2n2n
\begin{lemma}Let $A$ be a $2n \times 2n$ Hamiltonian matrix with distinct eigenvalues $\lambda_1, \ldots \lambda_n, -\lambda_1, \ldots  -\lambda_n $;  then there exists a symplectic matrix $S$ (possibly complex) such that $S^{-1}AS = diag(\lambda_1, \ldots, \lambda_n,-\lambda_1, \ldots -\lambda_n)$.
\end{lemma} \label{lem:2n2n}
\begin{proof}
See p46 of Meyer.
\end{proof}
%%%%%%%%%%%%%%%% unneeded.
\begin{comment}
\begin{lemma}Let A be a real $2 \times 2$ Hamiltonian matrix with eigenvalues $\pm\beta i$, $\beta \neq 0$. Then there exists a real $2 \times 2$ symplectic matrix $S$ such that:
\begin{equation}
S^{-1}AS = \begin{pmatrix} 0 & \beta \\ -\beta & 0 \end{pmatrix} \quad or \quad S^{-1}AS = \begin{pmatrix} 0 & -\beta \\ \beta & 0  \end{pmatrix}
\end{equation} \label{lem:real22}
\end{lemma}
\begin{proof}
See p47 Meyer.
\end{proof}
Possibly not needed.
\end{comment}
%%%%%%%%%%%%%%%% H to A
\begin{lemma}Let H be a real $2\times 2$ symmetric matrix with eigenvalues $\mu_1, \, \mu_2 > 0$ or $\mu_1, \, \mu_2 < 0$. This implies that $A=\Omega H$ has pure imaginary eigenvalues. \label{lem:htoa} \end{lemma} 
\begin{proof}
\begin{equation}
H = \begin{pmatrix} a & b \\ b & c \end{pmatrix}
\end{equation}
Using two eigenvalue identities,
\begin{equation}
\text{det}(M) = \prod_{i=1}^n \lambda_i \quad \text{and} \quad \text{Tr}(M) = \sum_{i=1}^n \lambda_i,
\end{equation}
where $M$ is an $n \times n$ matrix, we have
\begin{equation}
ac-b^2 = \mu_1\mu_2 \quad and \quad a+c = \mu_1+\mu_2.
\end{equation}
Now,
\begin{equation}
A = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix} \begin{pmatrix} a & b \\ b & c \end{pmatrix} = \begin{pmatrix} b & c \\ -a & -b \end{pmatrix}.
\end{equation}
The eigenvalues of A are therefore:
\begin{equation}
\lambda = \pm i\sqrt{\mu_1\mu_2}
\end{equation}
\end{proof}

Conversely
%%%%%%%%%%%%%%%% A to H
\begin{lemma}Consider the $2 \times 2$ matrix $A$ such that $A=\Omega H$, the eigenvalues of $A$ are $\pm i \beta$ and $H$ is real and symmetric. This implies that the eigenvalues of $H$ are positive or negative definite. \label{lem:atoh}
\end{lemma}
\begin{proof}
\begin{equation}
H = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \implies A = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix} \begin{pmatrix} a & b \\ c & d \end{pmatrix} = \begin{pmatrix} c & d \\ -a & b \end{pmatrix}
\end{equation}
so we know that
\begin{equation}
-bc+ad = \beta^2 \quad and \quad c-b=0
\end{equation}
using the two eigenvalue identities given in the proof above. One can check that these conditions are consistent and imply that the eigenvalues of $A$ are $\pm i \beta$.

Now write the characteristic equation for $H$:
\begin{equation}
\begin{aligned}
(a-\lambda)(d-\lambda) - bc &= \lambda^2-(a+d)\lambda +ad - bc = \lambda^2 - (a+d)\lambda + \beta^2, \\
\lambda &= \frac{1}{2}\left(a+d \pm \sqrt{(a+d)^2-4\beta^2}\right).
\end{aligned}
\end{equation}
We know that $(a+d)^2 \geq 4\beta^2$ because the eigenvalues must be real.

We also know that
\begin{equation}
| \sqrt{(a+d)^2 - 4\beta^2} | < |(a+d)|
\end{equation}
remembering that $a$ and $d$ may be negative.

As a result the only two options are that $H$ is positive or negative definite.
\end{proof}
%%%%%%%%%%%%%%% A diag
\begin{lemma} $A$ and $H$ are always block diagonalisable \label{lem:adiag} \end{lemma} 
\begin{proof}
A is always block diagonalisable: see p51 Meyer. $H = -\Omega A$ and therefore so is $H$.
\end{proof}

\begin{lemma} The characteristic polynomial of a real Hamiltonian matrix is an even polynomial. Thus, if $\lambda$ is an eigenvalue of a Hamiltonian matrix, then so are $-\lambda, \bar{\lambda}, -\bar{\lambda}$. \label{lem:hamevalues} \end{lemma}
\begin{proof}
See p45 Meyer.
\end{proof}

\section{Theorem}
\begin{theorem}$e^{\Omega Ht}$ is periodic if and only if each $H_j$, when $H$ is block diagonalised, is positive-definite, negative-definite or zero.
\end{theorem}
\begin{proof}
\textbf{Periodicity implies:} \\\\
Periodicity implies that $\exists$ T such that:
\begin{equation}
e^{A(t+T)}=e^{At} \implies e^{AT}=\mathbb{I}
\end{equation}
The identity matrix is diagonal and therefore A must be diagonalisable. This can be seen by taking the logarithm of the identity matrix. The eigenvalues of $A$ are restricted by the fact that it is Hamiltonian. This restriction is given by lemma (\ref{lem:hamevalues}). The periodicity condition implies that the eigenvalues of A are all pure imaginary, as solutions to the equation $e^x=1$.

Diagonalise $A$ such that
\begin{equation}
A' = V^{-1}AV= diag(0,0,\ldots,i\beta_1,-i\beta_1,\ldots,i\beta_m,-i\beta_m) = \bigoplus_{i=1}^n A'_j
\end{equation}
where
\begin{equation}
A'_j = \mathbf{0}_2 \quad \text{or} \quad \begin{pmatrix} i\beta_j & 0 \\ 0 & -i\beta_j \end{pmatrix}
\end{equation} 

Given a $2 \times 2$ real, Hamiltonian matrix, $A''_j$ with pure imaginary eigenvalues, $\pm i \beta_j$, it may be diagonalised so that it is in the form $\begin{pmatrix}  i\beta_j & 0 \\ 0 & -i\beta_j \end{pmatrix}$, by lemma (\ref{lem:2n2n}). This is via a similarity transform $A'_j = S^{-1}_jA''_jS_j=diag(i\beta_j,-i\beta_j)$. We would like to do the opposite of this to each of the $m$, nonzero submatrices of $A'$. So we have,
\begin{equation}
A'' = SA'S^{-1} = diag(\mathbf{0}_2,\mathbf{0}_2,\ldots,\tilde{A}_1, \ldots, \tilde{A}_m) = \bigoplus_{j=1}^n A''_j
\end{equation}
where
\begin{equation}
S = diag(\mathbb{I}_2,\mathbb{I}_2,\ldots S_1,S_2,\ldots S_m) 
\end{equation}
and
$\tilde{A}_i$ are the nonzero, $2 \times 2$ real submatrices of $A$ with pure imaginary, conjugate eigenvalues. (Incidentally $S \in Sp(2n,\mathbb{C})$).

So we have the new condition that
\begin{equation}
SV^{-1}e^{AT}VS^{-1} = e^{A''T} = \mathbb{I}
\end{equation}
must hold for all A. All this really means is that we have changed coordinates so that $A$ is a block diagonal $2n \times 2n$ real matrix. 

We then have
\begin{equation}
H = -\Omega A'' = \bigoplus_{i=1}^n H_j
\end{equation}
where $H_j$ is either $\mathbf{0}_2$ or a $2\times 2$ positive definite, or negative definite matrix by lemma (\ref{lem:atoh}).\\

\textbf{H implies:} \\\\
By lemma (\ref{lem:adiag}) H can be put in the form 
\begin{equation}
H = \bigoplus_{i=1}^n H_j.
\end{equation}
Lemma (\ref{lem:htoa}) implies that the eigenvalues of $A$ are now purely imaginary. A is diagonalisable by lemma (\ref{lem:2n2n}). This is equivalent to the periodicity definition.
\end{proof}

\end{document}